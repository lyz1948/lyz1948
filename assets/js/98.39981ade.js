(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{423:function(s,a,t){"use strict";t.r(a);var e=t(0),r=Object(e.a)({},function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),t("h2",{attrs:{id:"免sudo使用docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#免sudo使用docker","aria-hidden":"true"}},[s._v("#")]),s._v(" 免sudo使用docker")]),s._v(" "),t("p",[s._v("1.如果还没有 docker group 就添加一个")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("groupadd")]),s._v(" docker\n")])])]),t("p",[s._v("2.将用户加入该 group 内。然后退出并重新登录就生效啦")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" gpasswd -a "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${USER}")]),s._v(" docker\n")])])]),t("p",[s._v("3.重启 docker 服务")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" docker restart\n")])])]),t("p",[s._v("4.切换当前会话到新 group 或者重启 X 会话")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("newgrp - docker\n")])])]),t("h2",{attrs:{id:"启动容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动容器","aria-hidden":"true"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("idt ubuntu\n")])])]),t("h2",{attrs:{id:"查看启动中的容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看启动中的容器","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看启动中的容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker ps\n")])])]),t("h2",{attrs:{id:"查看所有容器（启动的和停止）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看所有容器（启动的和停止）","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看所有容器（启动的和停止）")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker ps "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a\n")])])]),t("h2",{attrs:{id:"进入容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#进入容器","aria-hidden":"true"}},[s._v("#")]),s._v(" 进入容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker exec "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("h2",{attrs:{id:"终止容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#终止容器","aria-hidden":"true"}},[s._v("#")]),s._v(" 终止容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker stop "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("h2",{attrs:{id:"删除容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除容器","aria-hidden":"true"}},[s._v("#")]),s._v(" 删除容器")]),s._v(" "),t("ul",[t("li",[s._v("需要先停止容器")])]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker rm "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("ul",[t("li",[s._v("直接删除运行中的容器")])]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker rm "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("容器id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("清理所有处于终止状态的容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker rm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("docker ps "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("q"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ndocker rm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("docker container ls "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"status=exited"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("q"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("h2",{attrs:{id:"下载镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载镜像","aria-hidden":"true"}},[s._v("#")]),s._v(" 下载镜像")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker pull "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("help\ndocker pull "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("选项"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Docker Registry地址"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("仓库名"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("标签"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),t("p",[s._v("下载ubuntu 14.04")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker pull ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.04")]),s._v("\n")])])]),t("h2",{attrs:{id:"运行一个容器，指定shell为-bash"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行一个容器，指定shell为-bash","aria-hidden":"true"}},[s._v("#")]),s._v(" 运行一个容器，指定Shell为 bash")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("rm ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.04")]),s._v(" bash\n")])])]),t("ul",[t("li",[s._v("docker run 运行容器的命令")]),s._v(" "),t("li",[s._v("it 这是2个参数的组合命令")]),s._v(" "),t("li",[s._v("-i 交互操作")]),s._v(" "),t("li",[s._v("-t 终端")]),s._v(" "),t("li",[s._v("-rm 容器退出后随即删除")]),s._v(" "),t("li",[s._v("ubuntu:14.04 指用ubuntu:14.04镜像为基础启动容器")]),s._v(" "),t("li",[s._v("bash 这里是指定运行Shell的bash")])]),s._v(" "),t("p",[s._v("查看当前系统的版本")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/os-release\n")])])]),t("p",[s._v("退出")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("exit\n")])])]),t("h2",{attrs:{id:"查看已安装的镜像列表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看已安装的镜像列表","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看已安装的镜像列表")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker images\n")])])]),t("h2",{attrs:{id:"虚悬镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#虚悬镜像","aria-hidden":"true"}},[s._v("#")]),s._v(" 虚悬镜像")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker images "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f dangling"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n")])])]),t("h2",{attrs:{id:"删除虚悬镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除虚悬镜像","aria-hidden":"true"}},[s._v("#")]),s._v(" 删除虚悬镜像")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker rmi "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("docker images "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("q "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f dangling"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("h2",{attrs:{id:"中间层镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#中间层镜像","aria-hidden":"true"}},[s._v("#")]),s._v(" 中间层镜像")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker images "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a\n")])])]),t("h2",{attrs:{id:"列出部分镜像（也就是说指定仓库名和标签）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#列出部分镜像（也就是说指定仓库名和标签）","aria-hidden":"true"}},[s._v("#")]),s._v(" 列出部分镜像（也就是说指定仓库名和标签）")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker images ubuntu\ndocker images ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.04")]),s._v("\n")])])]),t("h2",{attrs:{id:"以特定格式显示"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#以特定格式显示","aria-hidden":"true"}},[s._v("#")]),s._v(" 以特定格式显示")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker images -q\n\ndocker images --format "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{{.ID}}: {{.Repository}}"')]),s._v("\n\ndocker images --format "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"table {{.ID}}\\t{{.Repository}}\\t{{.Tag}}"')]),s._v("\n")])])]),t("h2",{attrs:{id:"nginx-服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-服务","aria-hidden":"true"}},[s._v("#")]),s._v(" Nginx 服务")]),s._v(" "),t("p",[s._v("启动一个 nginx 服务")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -d -p 80:80 --name webserver nginx\ndocker run --name webserver -d -p 80:80 nginx\n")])])]),t("p",[s._v("停止 nginx 服务")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker stop webserver\n")])])]),t("p",[s._v("删除 nginx 服务")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" webserver\n")])])]),t("h2",{attrs:{id:"docker-commit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-commit","aria-hidden":"true"}},[s._v("#")]),s._v(" docker commit")]),s._v(" "),t("p",[s._v("创建一个webserver服务")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name webserver "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" nginx\n")])])]),t("p",[s._v("进入容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker exec "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it webserver bash\n")])])]),t("p",[s._v("修改内容")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<h1>Hello, Docker!!</h1>'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("share"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html\n")])])]),t("h2",{attrs:{id:"dockerfile-定制镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-定制镜像","aria-hidden":"true"}},[s._v("#")]),s._v(" Dockerfile 定制镜像")]),s._v(" "),t("p",[s._v("1.创建Dockerfile文件")]),s._v(" "),t("p",[s._v("2.写入内如")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FROM")]),s._v(" nginx\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v(" echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello, Docker!!'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("share"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html\n")])])]),t("p",[s._v("3.构建镜像")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker build "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("context url"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\ndocker build "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("t nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])])]),t("p",[s._v("注意后面加了 ‘.’ 意思是在当前目录")]),s._v(" "),t("h2",{attrs:{id:"直接用git仓库进行构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#直接用git仓库进行构建","aria-hidden":"true"}},[s._v("#")]),s._v(" 直接用Git仓库进行构建")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker build https"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("github"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("twang2218"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gitlab"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("zh"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("git#"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.14")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("这行命令指定了构建所需的 Git repo，并且指定默认的 master 分支，构建目录为 /8.14/，然后 Docker 就会自己去 git clone 这个项目、切换到指定分支、并进入到指定目录后开始构建。")])]),s._v(" "),t("h2",{attrs:{id:"tar-压缩包构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tar-压缩包构建","aria-hidden":"true"}},[s._v("#")]),s._v(" tar 压缩包构建")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker build http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("server"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\n")])])]),t("h2",{attrs:{id:"从标准输入中读取-dockerfile-进行构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#从标准输入中读取-dockerfile-进行构建","aria-hidden":"true"}},[s._v("#")]),s._v(" 从标准输入中读取 Dockerfile 进行构建")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker build "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" Dockerfile\nor\ncat Dockerfile "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" docker build "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\n")])])]),t("h2",{attrs:{id:"从标准输入中读取上下文压缩包进行构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#从标准输入中读取上下文压缩包进行构建","aria-hidden":"true"}},[s._v("#")]),s._v(" 从标准输入中读取上下文压缩包进行构建")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker build "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" context"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\n")])])]),t("h2",{attrs:{id:"删除本地镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除本地镜像","aria-hidden":"true"}},[s._v("#")]),s._v(" 删除本地镜像")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker rmi "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("镜像"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("镜像"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker images\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" tip\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("REPOSITORY")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TAG")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IMAGE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CREATED")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SIZE")]),s._v("\nubuntu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("b969ab9f929b"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("months"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ago"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("188")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MB")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\ndocker rmi b96\n")])])]),t("h2",{attrs:{id:"用-docker-images-命令来配合"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用-docker-images-命令来配合","aria-hidden":"true"}},[s._v("#")]),s._v(" 用 docker images 命令来配合")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker rmi "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("docker images "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("q nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("h2",{attrs:{id:"docker-hub仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-hub仓库","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker Hub仓库")]),s._v(" "),t("p",[s._v("登陆")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker login\n")])])]),t("p",[s._v("输入用户名和密码")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker search ubuntu\n")])])]),t("p",[s._v("在没有登陆的情况下，也可以直接搜索docker hub仓库的镜像")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -d --net"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("host --restart"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always \\\n-e HUMPBACK_LISTEN_PORT"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8000 \\\n-v /opt/app/humpback-web/dbFiles:/humpback-web/dbFiles \\\n--name humpback-web \\\nhumpbacks/humpback-web:1.0.0\n")])])]),t("h2",{attrs:{id:"volumn"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#volumn","aria-hidden":"true"}},[s._v("#")]),s._v(" volumn")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("rm "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lyz"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lyz busybox sh\ndocker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("rm "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lyz"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lyz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" busybox sh\n")])])]),t("h2",{attrs:{id:"docker加速"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker加速","aria-hidden":"true"}},[s._v("#")]),s._v(" docker加速")]),s._v(" "),t("p",[s._v("阿里云镜像地址："),t("code",[s._v("https://dev.aliyun.com/search.html")]),s._v("\n参考学习地址："),t("a",{attrs:{href:"https://yeasy.gitbooks.io/docker_practice/",target:"_blank",rel:"noopener noreferrer"}},[s._v("传送门"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"docker无法下载镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker无法下载镜像","aria-hidden":"true"}},[s._v("#")]),s._v(" docker无法下载镜像")]),s._v(" "),t("p",[s._v("报错信息")]),s._v(" "),t("div",{staticClass:"language-html extra-class"},[t("pre",{pre:!0,attrs:{class:"language-html"}},[t("code",[s._v("Error response from daemon: Get https://registry-1.docker.io/v2/: net/http: request canceled while waiting for connection\n(Client.Timeout exceeded while awaiting headers)\n")])])]),t("blockquote",[t("p",[s._v("google了很久，尝试了很多方式都没有成功，最后问题是这样解决的\n修改DNS Servers的地址为 8.8.8.8\nMac在网络 => 打开网络偏好设置 => DNS")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://i.stack.imgur.com/uFgjq.png",alt:""}})]),s._v(" "),t("p",[s._v("创建一个overlay 的 network网络")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker network create "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d overlay network"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("demo\ndocker network ls\n")])])]),t("p",[s._v("开启一个mysql服务的容器，容器名字"),t("code",[s._v("mysql")]),s._v(" 环境变量配置以及挂载类型，指定连接的网络为network-demo")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker service create "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("env "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYSQL_DB_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("env "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYSQL_DATABASE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wordpress "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("network network"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("demo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("mount type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("volume"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("source"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("destination"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql mysql\n")])])]),t("p",[s._v("开启一个wordpress服务容器，将本地80端口指向容器80端口，配置环境变量以及指定network网络")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker service create "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name wordpress "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("env "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WORDPRESS_DB_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("env "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WORDPRESS_DB_HOST")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("network network"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("demo wordpress\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker service create "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name whoami "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("network net"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("demo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d jwilder"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("whoami\ndocker service ls\ndocker ps\ncurl "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n")])])]),t("p",[s._v("查看service容器的真正IP地址")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("uslookup task"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("whoami\n")])])]),t("h2",{attrs:{id:"docker-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-service","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker Service")]),s._v(" "),t("p",[s._v("创建一个docker service")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker service create "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name service"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("demo busybox sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true; do sleep 3600; done"')]),s._v("\n")])])]),t("p",[s._v("查看service信息")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker service ls\n")])])]),t("p",[s._v("修复服务数量")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker service scale service"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("demo"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n")])])]),t("p",[s._v("删除service服务")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker service rm "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("service name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("h2",{attrs:{id:"docker-swarm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-swarm","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker Swarm")]),s._v(" "),t("p",[s._v("docker-machine方式创建 docker swarm\n创建一个swarm管理的容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("machine create "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d virtualbox swarm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manage\n")])])]),t("p",[s._v("创建一个swarm worker1容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("machine create "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d virtualbox swarm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("worker1\n")])])]),t("p",[s._v("进入swarm-manage")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("machine ssh swarm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manage\n")])])]),t("p",[s._v("查看初始化帮助命令")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker swarm init "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("help\n")])])]),t("p",[s._v("初始化"),t("code",[s._v("docker swarm")]),s._v(" --advertise-addr= 容器ip, 容器ip可以通过 "),t("code",[s._v("ip a")]),s._v("查看")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker swarm init "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("advertise"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("addr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".99")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".101")]),s._v("\n")])])]),t("p",[s._v("初始化完成后，会得到下面一条命令, 复制该命令，退出当前的swarm-manage容器，进入另外一个需要管理的容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker swarm join "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("token "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SWMTKN")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("199")]),s._v("ngxu0zorrrvz2vd6ddh5pe4rjnvebieuvuxwiwy0gln0vye"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("fchlf18ilor533frgs40u4cy "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".99")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".101")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2377")]),s._v("\n")])])]),t("p",[s._v("进入另外一个虚拟机容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("machine ssh swarm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("worker1\n")])])]),t("p",[s._v("执行命令")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker swarm join "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("token "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SWMTKN")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("199")]),s._v("ngxu0zorrrvz2vd6ddh5pe4rjnvebieuvuxwiwy0gln0vye"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("fchlf18ilor533frgs40u4cy "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".99")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".101")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2377")]),s._v("\n")])])]),t("p",[s._v("在切换到swarm-manage虚拟机容器, 查看子节点")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("machine ssh swarm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manage\ndocker node ls\n")])])]),t("p",[s._v("使用"),t("code",[s._v("docker info")]),s._v(" 查看swarm的信息")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker@swarm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v("docker info\nSwarm"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" active\n NodeID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kll7b248h4n0s2v5p6s6c9uvi\n Is Manager"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n ClusterID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("k90cn8q5v7hb0xtqt43zfjiw\n Managers"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n Nodes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])])]),t("p",[s._v("现在我们来拉取一些镜像")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("H")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".99")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".101")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2376")]),s._v(" pull redis\ndocker "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("H")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".99")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".102")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2376")]),s._v(" pull mysql\n\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker@swarm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v("docker node ls\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ID")]),s._v("                            "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("HOSTNAME")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v("              "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AVAILABILITY")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MANAGER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ENGINE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("VERSION")]),s._v("\nkll7b248h4n0s2v5p6s6c9uvi "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("   swarm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("manage        Ready               Active              Leader              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.05")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce\nboqu6lj57panhvzaln1menk2q     swarm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("worker1       Ready               Active                                  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18.05")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ce\n")])])]),t("h2",{attrs:{id:"docker-compose"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker Compose")]),s._v(" "),t("p",[s._v("-f 参数指定执行文件")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compose "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("f docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compose"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yml up\n")])])]),t("p",[s._v("默认执行文件为 "),t("code",[s._v("docker-compose.yml")])]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compose up\n")])])]),t("p",[s._v("后台执行")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compose up "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compose images\n")])])]),t("p",[s._v("进入docker-compose构建的容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compose exec mysql bash\n")])])]),t("p",[s._v("负载均衡")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compose up "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("sacle web"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("version"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n\nservices"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n  wordpress"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    image"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wordpress\n    ports"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    environment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WORDPRESS_DB_HOST")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql\n      "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WORDPRESS_DB_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    networks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bridge\n\n  mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    image"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql\n    environment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n      "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYSQL_DATABASE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" wordpress\n    volumes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql\n    networks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bridge\n\n  volumes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n  networks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    my"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bridge"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      driver"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" bridge\n")])])]),t("h2",{attrs:{id:"安装wordpress"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装wordpress","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装wordpress")]),s._v(" "),t("p",[s._v("运行mysql")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("e "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("e "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("MYSQL_DATABASE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wordpress mysql\n")])])]),t("p",[s._v("运行wordpress")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("\ndocker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("e "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WORDPRESS_DB_HOST")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("link mysql "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" wordpress\n\n")])])]),t("h2",{attrs:{id:"docker-存储"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-存储","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker 存储")]),s._v(" "),t("p",[s._v("创建一个数据卷")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker volume create my"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vol\n")])])]),t("p",[s._v("查看已创建卷")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker volume ls\n")])])]),t("p",[s._v("查看卷详细信息")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker volume inspect my"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vol\n")])])]),t("p",[s._v("删除卷")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker volume rm my"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vol\n")])])]),t("p",[s._v("myvol目录映射到docker容器的app目录")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name devtest "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v myvol"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("app nginx\n\n")])])]),t("p",[s._v("将当前目录映射到虚拟机的"),t("code",[s._v("/usr/share/nginx/html")]),s._v(" 目录")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dp "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name myngxin "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("$")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pwd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("share"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html nginx\n")])])]),t("p",[s._v("查看devtest容器信息")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker inspect devtest\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker container stop devtest\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker container rm devtest\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker container rm myvol\n")])])]),t("h2",{attrs:{id:"多机通讯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多机通讯","aria-hidden":"true"}},[s._v("#")]),s._v(" 多机通讯")]),s._v(" "),t("p",[s._v("下载解压 etcd-v3.0.12-linux-amd64")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etcdctl cluster"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("health\n")])])]),t("h2",{attrs:{id:"linux-network-namespace"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-network-namespace","aria-hidden":"true"}},[s._v("#")]),s._v(" Linux Network NameSpace")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("查看network namespace 列表\n"),t("span",{pre:!0,attrs:{class:"token template-string"}},[t("span",{pre:!0,attrs:{class:"token string"}},[s._v("``")])]),s._v("`js\nsudo ip netns list\n")])])]),t("h2",{attrs:{id:"添加"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加","aria-hidden":"true"}},[s._v("#")]),s._v(" 添加")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("sudo ip netns add "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("netns"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("h2",{attrs:{id:"删除"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除","aria-hidden":"true"}},[s._v("#")]),s._v(" 删除")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("sudo ip netns "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("netns"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("h2",{attrs:{id:"查看"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看","aria-hidden":"true"}},[s._v("#")]),s._v(" 查看")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("sudo ip netns exec "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("netns"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ip a\n")])])]),t("h2",{attrs:{id:"ip-link"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ip-link","aria-hidden":"true"}},[s._v("#")]),s._v(" ip link")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("sudo ip netns exec "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("netns"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ip link\n\nsudo ip netns exec "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("netns"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ip link "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" dev lo up\n\nsudo ip link add veth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test1 type veth peer name veth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test2\n\nsudo ip link "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" veth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test1 netns test1\n\nsudo ip link "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" veth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test2 netns test2\n\nsudo ip netns exec test1 ip addr add "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" dev veth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test1\n\nsudo ip netns exec test2 ip addr add "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" dev veth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test2\n\nsudo ip netns exec test1 ip link "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" dev veth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test1 up\n\nsudo ip netns exec test2 ip link "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" dev veth"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test2 up\n\nsudo ip netns exec test1 ping "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),s._v("\n\nsudo ip netns exec test2 ping "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v("\n")])])]),t("p",[s._v("log")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker log 容器id\n")])])]),t("h2",{attrs:{id:"dockerfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile","aria-hidden":"true"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),t("p",[s._v("使用"),t("code",[s._v("Dockerfile")]),s._v(" 打包一个"),t("code",[s._v("stress")]),s._v(" tools")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FROM")]),s._v(" ubuntu\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v(" apt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" update "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" apt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" install "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y stress\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ENTRYPOINT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/stress"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("stress "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("vm "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nstress "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("vm "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v\n")])])]),t("p",[t("strong",[s._v("memory")])]),s._v(" "),t("p",[s._v("设定虚拟机内存200M --memory-swap在不设置的情况下默认同memory大小")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("memory"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("M lzy1948"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("stress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tool "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("vm "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v\n")])])]),t("p",[s._v("vm-bytes超出设定的memory 和memory-swap总量将自动退出")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("memory"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v("M lzy1948"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("stress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tool "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("vm "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("vm"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("bytes "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v("M\n")])])]),t("p",[s._v("设定cpu权重为5")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("cpu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("share"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name test1 lzy1948"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("stress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tool "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("cpu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),t("p",[s._v("设定cpu权重为10")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("cpu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("share"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name test2 lzy1948"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("stress"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tool "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("cpu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])])]),t("p",[s._v("创建一个data-container容器，运行另外一个容器并链接到data-container容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker create "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("v $"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PWD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("volData "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("container ubuntu\n\ndocker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("volumes"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" data"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("container ubuntu "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bash\n\ndocker tag docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx lzy1948"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1\n\ndocker push lzy1948"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("v1\n")])])]),t("h2",{attrs:{id:"docker-网络相关"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-网络相关","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker 网络相关")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("sudo yum install bridge"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("utils\n\nbrctl\n")])])]),t("p",[s._v("link")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("sudo docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name test1 busybox "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true; do sleep 3600; done"')]),s._v("\n\ndocker exec "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it test1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sh\n\ndocker ip a\n\nsudo docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name test2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("link test1 busybox "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true; do sleep 3600; done"')]),s._v("\n\ndocker exec "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it test2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sh\n\nping "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("test1 ip"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nping test1\n")])])]),t("p",[s._v("查看网络列表")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker network ls\n")])])]),t("p",[s._v("查看容器的IP地址")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker network inspect bridge\ndocker network inspect "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("test"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("创建一个网络")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker network create mynetwork"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test\n")])])]),t("p",[s._v("创建一个容器并链接到创建的网络")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("network mynetwork"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name test"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.04")]),s._v("\n")])])]),t("p",[s._v("将容器连接到网络")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("# test1 连接到mynetwork"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test\ndocker network connect mynetwork"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test test1\n")])])]),t("p",[s._v("格式化查看容器的网络配置")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker inspect "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("format"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{{json .NetworkSettings.Networks}}'")]),s._v(" test"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network\n")])])]),t("p",[s._v("从网络中移除已链接的容器")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker network disconnect bridge "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("demo")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker network create test"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network\n\ndocker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name ubuntu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test01 ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.04")]),s._v("\n\ndocker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dit "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name ubuntu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test02 ubuntu"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14.04")]),s._v("\n\ndocker network connect test"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network ubuntu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test01\n\ndocker network connect test"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network ubuntu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test02\n\ndocker network inspect test"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network\n\ndocker exec "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("it ubuntu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test01 bash\n\nping ubuntu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("test02\n")])])]),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("name test1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("network none busybox "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"while true; do sleep 3600; done"')]),s._v("\n")])])]),t("h2",{attrs:{id:"docker-构建一个nodejs服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-构建一个nodejs服务","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker 构建一个nodejs服务")]),s._v(" "),t("p",[s._v("创建一个目录")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("mkdir docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" cd docker"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node\n")])])]),t("p",[s._v("创建文件")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("touch app"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js\ntouch "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("json\ntouch Dockerfile\n")])])]),t("p",[s._v("写入内容\nDockerfile")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FROM")]),s._v(" node"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6.10")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("alpine\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ADD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("server"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WORKDIR")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("server"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RUN")]),s._v(" cd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("server"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" npm install\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXPOSE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3001")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CMD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"server.js"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("package.json")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker-node"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"private"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.0.0"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"description"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Node.js with docker"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"author"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"you@email.com"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dependencies"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"express"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.2.4"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("app.js")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" express "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PORT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3001")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" app "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("express")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\napp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" res")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello World\\n'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\napp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PORT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nconsole"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Running on http://127.0.0.1:'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PORT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("构建镜像\n在当前目录构建一个名为node-hello的image")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker build "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("t node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("hello "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])])]),t("p",[s._v("查看构建完成后的镜像")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker images\n")])])]),t("p",[s._v("运行node-hello镜像")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("docker run "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("d "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v(" node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("hello\n")])])]),t("p",[s._v("查询DNS")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("nslookup www"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ykpine"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com\n")])])])])},[],!1,null,null,null);a.default=r.exports}}]);