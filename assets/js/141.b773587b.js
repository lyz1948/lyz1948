(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{483:function(a,s,t){"use strict";t.r(s);var e=t(0),n=Object(e.a)({},function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"ubuntu服务器部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu服务器部署","aria-hidden":"true"}},[a._v("#")]),a._v(" Ubuntu服务器部署")]),a._v(" "),t("h2",{attrs:{id:"ssh连接到服务器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssh连接到服务器","aria-hidden":"true"}},[a._v("#")]),a._v(" ssh连接到服务器")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v(" -p yourport username@ip\n")])])]),t("h2",{attrs:{id:"免密码登录-用新增的用户登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#免密码登录-用新增的用户登录","aria-hidden":"true"}},[a._v("#")]),a._v(" 免密码登录(用新增的用户登录)")]),a._v(" "),t("p",[a._v("参考 这篇"),t("a",{attrs:{href:"./ssh"}},[a._v("ssh免密码登录")]),a._v(" 的文章")]),a._v(" "),t("h2",{attrs:{id:"修改登录的配置信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改登录的配置信息","aria-hidden":"true"}},[a._v("#")]),a._v(" 修改登录的配置信息")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/ssh/sshd_config\n")])])]),t("p",[a._v("1.端口号修改 修改1025～ 63560 之间的端口号\n2.添加用户")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("AllowUsers "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])])]),t("p",[a._v("3.是否允许空密码登录")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("PermitEmptyPasswords no\n")])])]),t("p",[a._v("4.是否允许root登录")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("PermitRootLogin no\n")])])]),t("p",[a._v("5.是否允许未添加key的电脑登录")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("PasswordAuthenthication no\n")])])]),t("h2",{attrs:{id:"重启ssh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启ssh","aria-hidden":"true"}},[a._v("#")]),a._v(" 重启ssh")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v(" restart\n")])])]),t("p",[a._v("新开窗口测试修改后的配置是否生效")]),a._v(" "),t("p",[a._v("用22端口登录测试\n用root账户登录和修改后的端口测试")]),a._v(" "),t("h2",{attrs:{id:"配置-iptables-和-fail2ban-增强安全防护"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-iptables-和-fail2ban-增强安全防护","aria-hidden":"true"}},[a._v("#")]),a._v(" 配置 iptables 和 Fail2Ban 增强安全防护")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" update "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" upgrade\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" iptables -F\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/iptables.up.rules\n")])])]),t("p",[a._v("配置"),t("code",[a._v("iptables")]),a._v("规则")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("*filter\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# allow all connections")]),a._v("\n-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# allow out traffic")]),a._v("\n-A OUTPUT -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# allow http https")]),a._v("\n-A INPUT -p tcp --dport 443 -j ACCEPT\n-A INPUT -p tcp --dport 80 -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# allow ssh port login")]),a._v("\n-A INPUT -p tcp -m state --state NEW --dport "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("端口号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ping")]),a._v("\n-A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mongodb connect")]),a._v("\n-A INPUT -s 127.0.0.1 -p tcp --destination-port "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("端口号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\n-A OUTPUT -d 127.0.0.1 -p tcp --source-port "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("端口号"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" -m state --state ESTABLISHED -j ACCEPT\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# log denied calls")]),a._v("\n-A INPUT -m limit --limit 5/min -j LOG --log-prefix "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"iptables denied:"')]),a._v(" --log-level 7\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# drop incoming sensitive connections")]),a._v("\n-A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --set\n-A INPUT -p tcp --dport 80 -i eth0 -m state --state NEW -m recent --update --seconds 60 --hitcount 150 -j DROP\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# reject all other inbound")]),a._v("\n-A INPUT -j REJECT\n-A FORWARD -j REJECT\n\nCOMMIT\n")])])]),t("h2",{attrs:{id:"重启iptables-restore"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启iptables-restore","aria-hidden":"true"}},[a._v("#")]),a._v(" 重启iptables-restore")]),a._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[a._v("sudo iptables"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("restore "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("iptables"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("up"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("rules\n")])])]),t("h2",{attrs:{id:"安装ufw"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装ufw","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装ufw")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" ufw\n")])])]),t("p",[a._v("查看防火墙是否激活")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ufw status\n")])])]),t("p",[a._v("输出显示 Status: active 则激活")]),a._v(" "),t("p",[a._v("开启防火墙")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" ufw "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("enable")]),a._v("\n")])])]),t("h2",{attrs:{id:"设置开机启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置开机启动","aria-hidden":"true"}},[a._v("#")]),a._v(" 设置开机启动")]),a._v(" "),t("p",[a._v("1.创建启动命令文件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/network/if-up.d/iptables\n")])])]),t("p",[a._v("2.写入启动命令")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[a._v("#!/bin/sh")]),a._v("\niptables-restore /etc/iptables.up.rules\n")])])]),t("p",[a._v("3.修改配置启动命令文件的权限")]),a._v(" "),t("p",[a._v("$ sudo chmod +x /etc/network/if-up.d/iptables")]),a._v(" "),t("h2",{attrs:{id:"安装fail2ban"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装fail2ban","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装fail2ban")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" fail2ban\n")])])]),t("p",[a._v("修改配置文件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/fail2ban/jail.conf\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("bantime  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" 3600\ndestemail "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("自己的邮箱"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\naction "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" %"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("action_mw"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("s\n")])])]),t("h2",{attrs:{id:"查看fail2ban-是否开启"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看fail2ban-是否开启","aria-hidden":"true"}},[a._v("#")]),a._v(" 查看fail2ban 是否开启")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" fail2ban status\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" fail2ban start\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("service")]),a._v(" fail2ban stop\n")])])]),t("h2",{attrs:{id:"删除apach"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除apach","aria-hidden":"true"}},[a._v("#")]),a._v(" 删除apach")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("update-rc.d -f apache2 remove\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" remove apache2\n")])])]),t("h2",{attrs:{id:"安装服务器中用到的其他程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装服务器中用到的其他程序","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装服务器中用到的其他程序")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" openssh build-essential libssl-dev "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v("\n")])])]),t("h2",{attrs:{id:"安装nvm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nvm","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装nvm")]),a._v(" "),t("p",[t("code",[a._v("nvm")]),a._v("的安装"),t("a",{attrs:{href:"./nvm"}},[a._v("nvm")])]),a._v(" "),t("h2",{attrs:{id:"安装nodejs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nodejs","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装nodejs")]),a._v(" "),t("p",[a._v("使用"),t("code",[a._v("nvm")]),a._v("安装与管理"),t("code",[a._v("nodejs")]),a._v("版本")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("nvm "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" v6.9.5\nnvm use v6.9.6\nnvm "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("alias")]),a._v(" default v6.9.5\nnode -v\n")])])]),t("p",[a._v("监控文件数目")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" fs.inotify.max_user_watches"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("523288 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tee")]),a._v(" -a /etc/sysctl.conf "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" sysctl -p\n")])])]),t("h2",{attrs:{id:"安装nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nginx","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装nginx")]),a._v(" "),t("p",[t("code",[a._v("nginx")]),a._v("的安装与使用"),t("a",{attrs:{href:"./nginx"}},[a._v("nginx")])]),a._v(" "),t("h2",{attrs:{id:"安装mongodb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装mongodb","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装mongodb")]),a._v(" "),t("p",[t("code",[a._v("nginx")]),a._v("的安装与使用"),t("a",{attrs:{href:"./mongodb"}},[a._v("nginx")])])])},[],!1,null,null,null);s.default=n.exports}}]);